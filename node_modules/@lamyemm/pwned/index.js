#!/usr/bin/env node

const chalk = require('chalk')
const axios = require('axios')
const ora = require('ora')
const validator = require('email-validator')
const args = process.argv[2]
const url = "https://haveibeenpwned.com/api/v2/breachedaccount/"
const spinner = ora({
    text: "it's downloading so be patient ok thank youuuu",
    spinner: {
        interval: 80,
        frames: [
            ".",
            "..",
            "...",
            "...."
        ]
    }
})

console.log(args);

if (validator.validate(args) == true) {



    spinner.start();

    // make a get request to the url

    axios({
        method: 'get',
        url: url + args,
        headers: { 'user-agent': 'cli' }, // this api needs this header set for the request
    })

        .then(res => {
            const breach = res.data;

            console.log(breach);

        }).catch(err => {

            if (err == "Error: Request failed with status code 404") {
                const log = chalk.yellow("No breach, go back to sleep") // we set the color red here for errors.
                console.log(log)
            }
        })
}


else {
    console.log('hmm your email is not an email so like what are you doing');
}
spinner.stop();






